import axios from "axios"
import { signOut } from "../../Redux/authentication/authAction"
import { fetchCardFailure, fetchCardRequest, fetchCardSuccess } from "../../Redux/placeCard/cardAction"


axios.interceptors.request.use(
    (req)=>{
      const tokenData=localStorage.getItem("token")
      if(tokenData){
      req.headers['authorization']=tokenData
      }
      return req
    },
    (err)=>{
       return Promise.reject(err)
    }
  )
  export const fetchCard =()=>{
    return(dispatch)=>{
        dispatch(fetchCardRequest)
        axios.get('http://localhost:8000/user/places')
        .then(response =>{
            const card=response.data
            dispatch(fetchCardSuccess(card))
            console.log(response);   
        })
        .catch(error =>{
            const errorMsg=error.Message
            dispatch(fetchCardFailure(errorMsg))
            console.log("error",error);
            if(error.response.data.authentication==false){
              console.log("authentication",error.response.data.authentication);
              dispatch(signOut())
            }
        })
    }
    
  }













































































































































































































































































































































